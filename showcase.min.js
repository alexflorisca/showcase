"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function throttle(a,b){var c;return function(d){c||(a(d),c=!0,setTimeout(function(){return c=!1},b))}}var Showcase=/*#__PURE__*/function(){function a(b,c){var d=this;if(_classCallCheck(this,a),!b)return void console.warn("No showcase element found");var e=this;return this.el=b,this.content=b.querySelector(".showcase__content"),this.slides=b.querySelectorAll(".showcase__slide"),this.content&&0!==this.slides.length?void(this.breakpoints=c.breakpoints||[600,1200],this.screenWidth=window.innerWidth,this.thumbsEl=null,this.thumbs=[],this.xDown=null,this.yDown=null,this.activeSlideIndex=0,this.slides[this.activeSlideIndex].classList.add("active"),this.content.addEventListener("keydown",function(a){37===a.keyCode&&d.prevSlide(),39===a.keyCode&&d.nextSlide()}),this.content.addEventListener("click",this.nextSlide.bind(e)),this.content.addEventListener("touchstart",throttle(this.handleTouchStart.bind(e),250)),this.content.addEventListener("touchmove",throttle(this.handleTouchMove.bind(e),250)),this.next=b.querySelector(".showcase__next"),this.prev=b.querySelector(".showcase__prev"),this.next&&this.prev&&(this.next.addEventListener("click",this.nextSlide.bind(e)),this.prev.addEventListener("click",this.prevSlide.bind(e))),window.addEventListener("resize",throttle(this.onScreenResize.bind(e),100)),this.addThumbs(),this.thumbsElGridStyle=this.getThumbsElGridStyle()):void console.warn("Invalid markup or no slides found")}return _createClass(a,[{key:"onScreenResize",value:function onScreenResize(){this.screenWidth=window.innerWidth,console.log(this.thumbsEl,this.innerWidth,this.breakpoints),this.updateThumbStyles()}// TODO: Tidy this if not needed
// setThumbsElGridStyle() {
// 	if(this.thumbsElGridStyle) {
// 		return this.thumbsElGridStyle;
// 	}
// 	const thumbCount = this.thumbsEl.children.length;
// 	const thumbWidth = (this.el.offsetWidth / thumbCount);
// 	const defaultThumbWidth = (this.el.offsetWidth / 5);
// 	const thumbColWidth = thumbWidth < defaultThumbWidth ? `1fr` : `${defaultThumbWidth}px`;
// 	this.thumbsElGridStyle = `repeat(${thumbCount}, ${thumbColWidth})`;
// }
},{key:"setImageThumbs",value:function setImageThumbs(){this.el.classList.remove("showcase--grid"),this.thumbsEl.classList.remove("showcase__thumbs--dot"),this.thumbsEl.classList.add("showcase__thumbs--img")}},{key:"setDotThumbs",value:function setDotThumbs(){Array.from(this.thumbsEl.children).forEach(function(a){a.style.width=null}),this.el.classList.remove("showcase--grid"),this.thumbsEl.classList.remove("showcase__thumbs--img"),this.thumbsEl.classList.add("showcase__thumbs--dot")}},{key:"removeThumbs",value:function removeThumbs(){this.el.classList.add("showcase--grid"),this.thumbsEl.classList.remove("showcase__thumbs--dot"),this.thumbsEl.classList.remove("showcase__thumbs--img")}},{key:"updateThumbStyles",value:function updateThumbStyles(){this.screenWidth<this.breakpoints[0]?this.setDotThumbs():this.screenWidth>this.breakpoints[0]&&this.screenWidth<this.breakpoints[1]?this.setImageThumbs():this.removeThumbs()}},{key:"addThumbs",value:function addThumbs(){var a=this;this.thumbsEl=document.createElement("div"),this.thumbsEl.setAttribute("role","tablist"),this.thumbsEl.classList.add("showcase__thumbs"),this.el.appendChild(this.thumbsEl),this.slides.forEach(function(c,d){var e=document.createElement("button");e.setAttribute("data-slide-index",d),e.setAttribute("aria-label","Image ".concat(d+1)),e.innerHTML="<img src=\"".concat(c.firstChild.getAttribute("src"),"\">"),d===a.activeSlideIndex&&e.classList.add("active"),e.addEventListener("click",function(){a.changeActiveSlide(d)}),a.thumbs[d]=e,a.thumbsEl.appendChild(e)}),this.updateThumbStyles()}},{key:"changeActiveSlide",value:function changeActiveSlide(a){this.slides[this.activeSlideIndex].classList.remove("active"),this.slides[a].classList.add("active"),0<this.thumbs.length&&(this.thumbs[this.activeSlideIndex].classList.remove("active"),this.thumbs[a].classList.add("active")),this.activeSlideIndex=a,this.slides[this.activeSlideIndex].focus()}},{key:"nextSlide",value:function(){var a=this.activeSlideIndex===this.slides.length-1?0:this.activeSlideIndex+1;this.changeActiveSlide(a)}},{key:"prevSlide",value:function prevSlide(){var a=0===this.activeSlideIndex?this.slides.length-1:this.activeSlideIndex-1;this.changeActiveSlide(a)}},{key:"handleTouchStart",value:function handleTouchStart(a){this.xDown=a.touches[0].clientX,this.yDown=a.touches[0].clientY}},{key:"handleTouchMove",value:function handleTouchMove(a){var b=Math.abs;if(this.xDown&&this.yDown){var c=a.touches[0].clientX,d=a.touches[0].clientY,e=this.xDown-c,f=this.yDown-d;b(e)>b(f)&&(0<e?this.nextSlide():this.prevSlide()),this.xDown=null,this.yDown=null}}}]),a}();window.Showcase=Showcase;
